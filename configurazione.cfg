/*** [SECTION 0000] ***/
lockPref("rischio.fox", "Codice Errore: 0000");
/* Abilita scorrimento automatico ***/
defaultPref("general.autoScroll", true);
/* Disabilitare icona microfono ***/
defaultPref("privacy.webrtc.legacyGlobalIndicator", false);
/* Disabilitare popup traduttore ***/
defaultPref("browser.translations.automaticallyPopup", false);
/* integrazione desktop environment ***/
defaultPref("media.hardwaremediakeys.enabled", false); // Ridondante con Plasma Integration
defaultPref("widget.use-xdg-desktop-portal.file-picker", 1); // default 2
defaultPref("widget.use-xdg-desktop-portal.location", 1); // default 2
defaultPref("widget.use-xdg-desktop-portal.mime-handler", 1); // default 2
defaultPref("widget.use-xdg-desktop-portal.open-uri", 1); // default 2
defaultPref("widget.use-xdg-desktop-portal.settings", 1); // default 2
/* NEWTAB ***/
defaultPref("browser.newtabpage.activity-stream.feeds.section.topstories", false);
defaultPref("browser.newtabpage.activity-stream.impressionId", "");
defaultPref("browser.newtabpage.activity-stream.improvesearch.handoffToAwesomebar", false); // Ripristinare searchbox
defaultPref("browser.newtabpage.activity-stream.improvesearch.topSiteSearchShortcuts.havePinned", "");

/*** [SECTION 0001]: FASTFOX ***/
lockPref("rischio.fox", "Codice Errore: 0001");
/* GENERAL ***/
defaultPref("content.notify.interval", 100000); // default=120000
/* GFX ***/
// [WARNING] May cause issues on some Windows machines using integrated GPUs
defaultPref("gfx.canvas.accelerated.cache-items", 4096); // default=2048
defaultPref("gfx.canvas.accelerated.cache-size", 512); // default=256
defaultPref("gfx.content.skia-font-cache-size", 20); // default=5
/* DISK CACHE ***/
defaultPref("browser.cache.jsbc_compression_level", 3); // default=0
/* MEDIA CACHE ***/
defaultPref("media.memory_cache_max_size", 65536); // default=8192
defaultPref("media.cache_readahead_limit", 7200); // default=3600
defaultPref("media.cache_resume_threshold", 3600); // default=1800
/* IMAGE CACHE ***/
defaultPref("image.mem.decode_bytes_at_a_time", 32768); // default=16384
/* NETWORK ***/
defaultPref("network.buffer.cache.size", 262144); // 256 kb; default=32768
defaultPref("network.buffer.cache.count", 128); // default=24
defaultPref("network.http.max-connections", 1800); // default=900
defaultPref("network.http.max-persistent-connections-per-server", 10); // default=6;
defaultPref("network.http.max-urgent-start-excessive-connections-per-host", 5); // default=3
defaultPref("network.http.pacing.requests.enabled", false);
defaultPref("network.dnsCacheExpiration", 86400);
defaultPref("network.dns.max_high_priority_threads", 8); // default=5
defaultPref("network.ssl_tokens_cache_capacity", 10240); // default=2048;
/* EXPERIMENTAL ***/
defaultPref("layout.css.grid-template-masonry-value.enabled", true);
defaultPref("dom.enable_web_task_scheduling", true);
defaultPref("layout.css.has-selector.enabled", true);
defaultPref("dom.security.sanitizer.enabled", true);

/*** [SECTION 0002]: SECUREFOX ***/
lockPref("rischio.fox", "Codice Errore: 0002");
/* TRACKING PROTECTION ***/
defaultPref("network.cookie.sameSite.noneRequiresSecure", true);
lockPref("privacy.globalprivacycontrol.enabled", true);
lockPref("privacy.globalprivacycontrol.functionality.enabled", true);
/* DISK AVOIDANCE ***/
defaultPref("browser.sessionstore.interval", 60000);
/* SEARCH / URL BAR ***/
defaultPref("browser.urlbar.update2.engineAliasRefresh", true);
lockPref("security.insecure_connection_text.enabled", true);
lockPref("security.insecure_connection_text.pbmode.enabled", true);
lockPref("network.IDN_show_punycode", true);
defaultPref("signon.privateBrowsingCapture.enabled", false);
defaultPref("editor.truncate_user_pastes", false);
/* ADDRESS + CREDIT CARD MANAGER ***/
defaultPref("extensions.formautofill.addresses.enabled", false);
defaultPref("extensions.formautofill.creditCards.enabled", false);
/* MIXED CONTENT + CROSS-SITE ***/
defaultPref("security.mixed_content.block_display_content", true);
lockPref("security.mixed_content.upgrade_display_content", true);
lockPref("security.mixed_content.upgrade_display_content.image", true);

/*** [SECTION 0003]: PESKYFOX ***/
lockPref("rischio.fox", "Codice Errore: 0003");
/* MOZILLA UI ***/
defaultPref("browser.privatebrowsing.vpnpromourl", "");
defaultPref("browser.shell.checkDefaultBrowser", false);
defaultPref("browser.preferences.moreFromMozilla", false);
defaultPref("browser.tabs.tabmanager.enabled", false);
defaultPref("browser.aboutConfig.showWarning", false);
defaultPref("browser.aboutwelcome.enabled", false);
/* THEME ADJUSTMENTS ***/
defaultPref("toolkit.legacyUserProfileCustomizations.stylesheets", true); // Abilita userChrome.css
defaultPref("browser.compactmode.show", true);
defaultPref("browser.display.focus_ring_on_anything", true);
defaultPref("browser.display.focus_ring_style", 0);
defaultPref("browser.display.focus_ring_width", 0);
/* COOKIE BANNER HANDLING ***/
lockPref("cookiebanners.service.mode", 2);
lockPref("cookiebanners.service.mode.privateBrowsing", 2);
lockPref("cookiebanners.service.enableGlobalRules", true);
/* URL BAR ***/
defaultPref("browser.urlbar.suggest.calculator", true);
defaultPref("browser.urlbar.unitConversion.enabled", true);
defaultPref("browser.urlbar.trending.featureGate", false);
/* POCKET ***/
defaultPref("extensions.pocket.enabled", false);
/* PDF ***/
defaultPref("browser.download.open_pdf_attachments_inline", true);
/* TAB BEHAVIOR ***/
defaultPref("browser.bookmarks.openInTabClosesMenu", false);
defaultPref("browser.menu.showViewImageInfo", true);
defaultPref("findbar.highlightAll", true);
defaultPref("layout.word_select.eat_space_to_next_word", false);

/*** [SECTION 0100]: STARTUP ***/
lockPref("rischio.fox", "Codice Errore: 0100");
/* 0105: disable sponsored content on Firefox Home (Activity Stream) ***/
defaultPref("browser.newtabpage.activity-stream.showSponsored", false); // [FF58+] Pocket > Sponsored Stories
defaultPref("browser.newtabpage.activity-stream.showSponsoredTopSites", false); // [FF83+] Sponsored shortcuts
/* 0106: clear default topsites ***/
defaultPref("browser.newtabpage.activity-stream.default.sites", "");

/*** [SECTION 0200]: GEOLOCATION / LANGUAGE / LOCALE ***/
lockPref("rischio.fox", "Codice Errore: 0200");
/* 0201: use Mozilla geolocation service instead of Google if permission is granted [FF74+] ***/
lockPref("geo.provider.network.url", "https://location.services.mozilla.com/v1/geolocate?key=%MOZILLA_API_KEY%");
/* 0202: disable using the OSs geolocation service ***/
defaultPref("geo.provider.use_gpsd", false); // [LINUX]
defaultPref("geo.provider.use_geoclue", false); // [FF102+] [LINUX]

/*** [SECTION 0320]: RECOMMENDATIONS ***/
lockPref("rischio.fox", "Codice Errore: 0320");
/* 0320: disable recommendation pane in about:addons (uses Google Analytics) ***/
lockPref("extensions.getAddons.showPane", false); // [HIDDEN PREF]
/* 0321: disable recommendations in about:addons Extensions and Themes panes [FF68+] ***/
lockPref("extensions.htmlaboutaddons.recommendations.enabled", false);
/* 0322: disable personalized Extension Recommendations in about:addons and AMO [FF65+] ***/
lockPref("browser.discovery.enabled", false);
/* 0323: disable shopping experience [FF116+] ***/
defaultPref("browser.shopping.experience2023.enabled", false); // [DEFAULT: false]

/*** [SECTION 0330]: TELEMETRY ***/
lockPref("rischio.fox", "Codice Errore: 0330");
/* 0330: disable new data submission [FF41+] ***/
lockPref("datareporting.policy.dataSubmissionEnabled", false);
/* 0331: disable Health Reports ***/
lockPref("datareporting.healthreport.uploadEnabled", false);
/* 0332: disable telemetry ***/
lockPref("toolkit.telemetry.unified", false);
lockPref("toolkit.telemetry.enabled", false); // see [NOTE]
lockPref("toolkit.telemetry.server", "data:,");
lockPref("toolkit.telemetry.archive.enabled", false);
lockPref("toolkit.telemetry.newProfilePing.enabled", false); // [FF55+]
lockPref("toolkit.telemetry.shutdownPingSender.enabled", false); // [FF55+]
lockPref("toolkit.telemetry.updatePing.enabled", false); // [FF56+]
lockPref("toolkit.telemetry.bhrPing.enabled", false); // [FF57+] Background Hang Reporter
lockPref("toolkit.telemetry.firstShutdownPing.enabled", false); // [FF57+]
/* 0333: disable Telemetry Coverage ***/
lockPref("toolkit.telemetry.coverage.opt-out", true); // [HIDDEN PREF]
lockPref("toolkit.coverage.opt-out", true); // [FF64+] [HIDDEN PREF]
lockPref("toolkit.coverage.endpoint.base", "");
/* 0334: disable PingCentre telemetry (used in several System Add-ons) [FF57+] ***/
lockPref("browser.ping-centre.telemetry", false);
/* 0335: disable Firefox Home (Activity Stream) telemetry ***/
lockPref("browser.newtabpage.activity-stream.feeds.telemetry", false);
lockPref("browser.newtabpage.activity-stream.telemetry", false);

/** [SECTION 0340]: STUDIES ***/
lockPref("rischio.fox", "Codice Errore: 0340");
/* 0340: disable Studies ***/
lockPref("app.shield.optoutstudies.enabled", false);
/* 0341: disable Normandy/Shield [FF60+] ***/
lockPref("app.normandy.enabled", false);
lockPref("app.normandy.api_url", "");

/** [SECTION 0350]: CRASH REPORTS ***/
lockPref("rischio.fox", "Codice Errore: 0350");
/* 0350: disable Crash Reports ***/
defaultPref("breakpad.reportURL", "");
defaultPref("browser.tabs.crashReporting.sendReport", false); // [FF44+]
defaultPref("browser.crashReports.unsubmittedCheck.enabled", false); // [FF51+] [DEFAULT: false]
/* 0351: enforce no submission of backlogged Crash Reports [FF58+]  ***/
defaultPref("browser.crashReports.unsubmittedCheck.autoSubmit2", false); // [DEFAULT: false]

/** [SECTION 0360]: OTHER ***/
lockPref("rischio.fox", "Codice Errore: 0360");
/* 0360: disable Captive Portal detection ***/
defaultPref("captivedetect.canonicalURL", "");
defaultPref("network.captive-portal-service.enabled", false); // [FF52+]
/* 0361: disable Network Connectivity checks [FF65+] ***/
defaultPref("network.connectivity-service.enabled", false);

/*** [SECTION 0600]: BLOCK IMPLICIT OUTBOUND [not explicitly asked for - e.g. clicked on] ***/
lockPref("rischio.fox", "Codice Errore: 0600");
/* 0601: disable link prefetching ***/
lockPref("network.prefetch-next", false);
/* 0602: disable DNS prefetching ***/
lockPref("network.dns.disablePrefetch", true);
lockPref("network.dns.disablePrefetchFromHTTPS", true); // [DEFAULT: true]
/* 0603: disable predictor / prefetching ***/
lockPref("network.predictor.enabled", false);
lockPref("network.predictor.enable-prefetch", false); // [FF48+] [DEFAULT: false]
/* 0604: disable link-mouseover opening connection to linked server ***/
lockPref("network.http.speculative-parallel-limit", 0);
/* 0605: disable mousedown speculative connections on bookmarks and history [FF98+] ***/
lockPref("browser.places.speculativeConnect.enabled", false);
/* 0610: enforce no "Hyperlink Auditing" (click tracking) ***/
lockPref("browser.send_pings", false); // [DEFAULT: false]

/*** [SECTION 0700]: DNS / DoH / PROXY / SOCKS ***/
lockPref("rischio.fox", "Codice Errore: 0700");
/* 0702: set the proxy server to do any DNS lookups when using SOCKS ***/
lockPref("network.proxy.socks_remote_dns", true);
/* 0703: disable using UNC (Uniform Naming Convention) paths [FF61+] ***/
lockPref("network.file.disable_unc_paths", true); // [HIDDEN PREF]
/* 0704: disable GIO as a potential proxy bypass vector ***/
lockPref("network.gio.supported-protocols", ""); // [HIDDEN PREF] [DEFAULT: "" FF118+]
/* 0710: enable DNS-over-HTTPS (DoH) [FF60+] ***/
lockPref("network.trr.mode", 3);
/* 0712: set DoH provider ***/
defaultPref("network.trr.uri", "https://dns.quad9.net/dns-query");
defaultPref("network.trr.custom_uri", "https://dns.quad9.net/dns-query");

/*** [SECTION 0800]: LOCATION BAR / SEARCH BAR / SUGGESTIONS / HISTORY / FORMS ***/
lockPref("rischio.fox", "Codice Errore: 0800");
/* 0801: disable location bar making speculative connections [FF56+] ***/
lockPref("browser.urlbar.speculativeConnect.enabled", false);
/* 0802: disable location bar contextual suggestions [FF92+] ***/
defaultPref("browser.urlbar.suggest.quicksuggest.nonsponsored", false); // [FF95+]
lockPref("browser.urlbar.suggest.quicksuggest.sponsored", false);
/* 0805: disable urlbar trending search suggestions [FF118+] ***/
defaultPref("browser.urlbar.trending.featureGate", false);
/* 0806: disable urlbar suggestions ***/
defaultPref("browser.urlbar.addons.featureGate", false); // [FF115+]
defaultPref("browser.urlbar.mdn.featureGate", false); // [FF117+] [HIDDEN PREF]
defaultPref("browser.urlbar.pocket.featureGate", false); // [FF116+] [DEFAULT: false]
defaultPref("browser.urlbar.weather.featureGate", false); // [FF108+] [DEFAULT: false]
/* 0807: disable urlbar clipboard suggestions [FF118+] ***/
defaultPref("browser.urlbar.clipboard.featureGate", false); // [DEFAULT: false]
/* 0810: disable search and form history ***/
defaultPref("browser.formfill.enable", false);
/* 0830: enable separate default search engine in Private Windows and its UI setting ***/
lockPref("browser.search.separatePrivateDefault", true); // [FF70+]
lockPref("browser.search.separatePrivateDefault.ui.enabled", true); // [FF71+]

/*** [SECTION 0900]: PASSWORDS ***/
lockPref("rischio.fox", "Codice Errore: 0900");
/* 0903: disable auto-filling username & password form fields ***/
lockPref("signon.autofillForms", false);
/* 0904: disable formless login capture for Password Manager [FF51+] ***/
lockPref("signon.formlessCapture.enabled", false);
/* 0905: limit (or disable) HTTP authentication credentials dialogs triggered by sub-resources [FF41+] ***/
lockPref("network.auth.subresource-http-auth-allow", 1);

/*** [SECTION 1000]: DISK AVOIDANCE ***/
lockPref("rischio.fox", "Codice Errore: 1000");
/* 1002: disable media cache from writing to disk in Private Browsing ***/
defaultPref("browser.privatebrowsing.forceMediaMemoryCache", true); // [FF75+]
defaultPref("media.memory_cache_max_size", 65536);
/* 1003: disable storing extra session data [SETUP-CHROME] ***/
defaultPref("browser.sessionstore.privacy_level", 2);

/** [SECTION 1200]: SSL (Secure Sockets Layer) / TLS (Transport Layer Security) ***/
lockPref("rischio.fox", "Codice Errore: 1200");
/* 1201: require safe negotiation ***/
lockPref("security.ssl.require_safe_negotiation", true);
/* 1206: disable TLS1.3 0-RTT (round-trip time) [FF51+] ***/
lockPref("security.tls.enable_0rtt_data", false);

/** [SECTION 1210]: OCSP (Online Certificate Status Protocol) ***/
lockPref("rischio.fox", "Codice Errore: 1210");
/* 1211: enforce OCSP fetching to confirm current validity of certificates ***/
lockPref("security.OCSP.enabled", 1); // [DEFAULT: 1]
/* 1212: set OCSP fetch failures (non-stapled, see 1211) to hard-fail ***/
lockPref("security.OCSP.require", true);

/** [SECTION 1220]: CERTS / HPKP (HTTP Public Key Pinning) ***/
lockPref("rischio.fox", "Codice Errore: 1220");
/* 1223: enable strict PKP (Public Key Pinning) ***/
lockPref("security.cert_pinning.enforcement_level", 2);
/* 1224: enable CRLite [FF73+] ***/
lockPref("security.remote_settings.crlite_filters.enabled", true);
lockPref("security.pki.crlite_mode", 2);

/** [SECTION 1240]: MIXED CONTENT ***/
lockPref("rischio.fox", "Codice Errore: 1240");
/* 1244: enable HTTPS-Only mode in all windows [FF76+] ***/
lockPref("dom.security.https_only_mode", true); // [FF76+]
/* 1246: disable HTTP background requests [FF82+] ***/
defaultPref("dom.security.https_only_mode_send_http_background_request", false);

/** [SECTION 1270]: UI (User Interface) ***/
lockPref("rischio.fox", "Codice Errore: 1270");
/* 1270: display warning on the padlock for "broken security" (if 1201 is false) ***/
lockPref("security.ssl.treat_unsafe_negotiation_as_broken", true);
/* 1272: display advanced information on Insecure Connection warning pages ***/
lockPref("browser.xul.error_pages.expert_bad_cert", true);

/*** [SECTION 1600]: REFERERS ***/
lockPref("rischio.fox", "Codice Errore: 1600");
/* 1602: control the amount of cross-origin information to send [FF52+] ***/
defaultPref("network.http.referer.XOriginTrimmingPolicy", 2);

/*** [SECTION 1700]: CONTAINERS ***/
lockPref("rischio.fox", "Codice Errore: 1700");
/* 1701: enable Container Tabs and its UI setting [FF50+] ***/
lockPref("privacy.userContext.enabled", true);
lockPref("privacy.userContext.ui.enabled", false);

/*** [SECTION 2000]: PLUGINS / MEDIA / WEBRTC ***/
lockPref("rischio.fox", "Codice Errore: 2000");
/* 2002: force WebRTC inside the proxy [FF70+] ***/
lockPref("media.peerconnection.ice.proxy_only_if_behind_proxy", true);
/* 2003: force a single network interface for ICE candidates generation [FF42+] ***/
defaultPref("media.peerconnection.ice.default_address_only", true);

/*** [SECTION 2400]: DOM (DOCUMENT OBJECT MODEL) ***/
lockPref("rischio.fox", "Codice Errore: 2400");
/* 2402: prevent scripts from moving and resizing open windows ***/
defaultPref("dom.disable_window_move_resize", true);

/*** [SECTION 2600]: MISCELLANEOUS ***/
lockPref("rischio.fox", "Codice Errore: 2600");
/* 2603: remove temp files opened from non-PB windows with an external application ***/
defaultPref("browser.download.start_downloads_in_tmp_dir", true); // [FF102+]
defaultPref("browser.helperApps.deleteTempFileOnExit", true);
/* 2606: disable UITour backend so there is no chance that a remote page can use it ***/
lockPref("browser.uitour.enabled", false);
/* 2608: reset remote debugging to disabled ***/
lockPref("devtools.debugger.remote-enabled", false); // [DEFAULT: false]
/* 2616: remove special permissions for certain mozilla domains [FF35+] ***/
defaultPref("permissions.manager.defaultsUrl", "");
/* 2617: remove webchannel whitelist ***/
defaultPref("webchannel.allowObject.urlWhitelist", "");
/* 2619: use Punycode in Internationalized Domain Names to eliminate possible spoofing ***/
lockPref("network.IDN_show_punycode", true);
/* 2620: enforce PDFJS, disable PDFJS scripting ***/
lockPref("pdfjs.disabled", false); // [DEFAULT: false]
lockPref("pdfjs.enableScripting", false); // [FF86+]
/* 2624: disable middle click on new tab button opening URLs or searches using clipboard [FF115+] */
defaultPref("browser.tabs.searchclipboardfor.middleclick", false); // [DEFAULT: false NON-LINUX]

/** [SECTION 2650]: DOWNLOADS ***/
lockPref("rischio.fox", "Codice Errore: 2650");
/* 2651: enable user interaction for security by always asking where to download ***/
defaultPref("browser.download.useDownloadDir", false);
/* 2652: disable downloads panel opening on every download [FF96+] ***/
defaultPref("browser.download.alwaysOpenPanel", false);
/* 2653: disable adding downloads to the system s "recent documents" list ***/
defaultPref("browser.download.manager.addToRecentDocs", false);
/* 2654: enable user interaction for security by always asking how to handle new mimetypes [FF101+] ***/
defaultPref("browser.download.always_ask_before_handling_new_types", true);

/** [SECTION 2660]: EXTENSIONS ***/
lockPref("rischio.fox", "Codice Errore: 2660");
/* 2660: lock down allowed extension directories ***/
defaultPref("extensions.enabledScopes", 5); // [HIDDEN PREF]
/* 2661: disable bypassing 3rd party extension install prompts [FF82+] ***/
defaultPref("extensions.postDownloadThirdPartyPrompt", false);

/*** [SECTION 2700]: ETP (ENHANCED TRACKING PROTECTION) ***/
lockPref("rischio.fox", "Codice Errore: 2700");
/* 2701: enable ETP Strict Mode [FF86+]s ***/
lockPref("browser.contentblocking.category", "strict");

/*** [SECTION 2800]: SHUTDOWN & SANITIZING ***/
lockPref("rischio.fox", "Codice Errore: 2800");
/* 2810: enable Firefox to clear items on shutdown ***/
defaultPref("privacy.sanitize.sanitizeOnShutdown", false);

/*** [SECTION 5000]: OPTIONAL ***/
lockPref("rischio.fox", "Codice Errore: 5000");
/* 5016: discourage downloading to desktop
defaultPref("browser.download.folderList", 1);
/* 5019: disable page thumbnail collection ***/
lockPref("browser.pagethumbnails.capturing_disabled", true); // [HIDDEN PREF]
/* 5508: disable all DRM content (EME: Encryption Media Extension) ***/
defaultPref("media.eme.enabled", true);
defaultPref("browser.eme.ui.enabled", false);
/* 5509: disable IPv6 ***/
defaultPref("network.dns.disableIPv6", true);

/*** [SECTION 7000]: DON T BOTHER ***/
lockPref("rischio.fox", "Codice Errore: 7000");
/* 7002: set default permissions ***/
defaultPref("permissions.default.camera", 2);
defaultPref("permissions.default.desktop-notification", 2);
defaultPref("permissions.default.geo", 2);
defaultPref("permissions.default.microphone", 2);
defaultPref("permissions.default.shortcuts", 2);
defaultPref("permissions.default.xr", 2);

/*** [SECTION 9000]: NON-PROJECT RELATED ***/
lockPref("rischio.fox", "Codice Errore: 9000");
/* 9001: disable welcome notices ***/
defaultPref("browser.startup.homepage_override.mstone", "ignore");
/* 9002: disable General>Browsing>Recommend extensions/features as you browse [FF67+] ***/
defaultPref("browser.newtabpage.activity-stream.asrouter.userprefs.cfr.addons", false);
defaultPref("browser.newtabpage.activity-stream.asrouter.userprefs.cfr.features", false);
/* 9003: disable What s New toolbar icon [FF69+] ***/
defaultPref("browser.messaging-system.whatsNewPanel.enabled", false);

/*** [FINE] ***/
lockPref("rischio.fox", "Versione 119.1");
